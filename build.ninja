rule updatesubmodules
    command = git submodule update

rule genprotos
    command = ./genprotos.sh

rule sqlc
    command = sqlc generate

rule gobuild
    command = GO111MODULE=on go build

build legato-sqlc: sqlc
build legato-protobuf: genprotos
build legato-submodules: updatesubmodules
build legato-binary: gobuild legato-sqlc legato-protobuf legato-submodules
